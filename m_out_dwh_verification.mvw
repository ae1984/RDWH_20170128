create materialized view U1.M_OUT_DWH_VERIFICATION
build deferred
refresh complete on demand
as
select v.id,
       v.in_id,
       cast (v.portition_date as date) as portition_date,
       v.client_id,
       v.verification_id,
       v.folders_id,
       cast (v.folders_date as date) as folders_date,
       v.folder_number,
       v.folder_status,
       v.last_name,
       v.first_name,
       v.sur_name,
       v.iin,
       cast (v.date_birth as date) as date_birth,
       v.branch_manager,
       v.verify_status,
       v.verify_group,
       v.verify_pr_cr,
       v.pkb_is_empty,
       cast (v.date_last_edit as date) as date_last_edit,
       cast (v.date_create as date) as date_create,
       v.need_verify_cont,
       v.need_verify_modified_data,
       v.segment_group,
       cast (v.from_rfo_to_is as date) as from_rfo_to_is,
       v.is_untreated,
       cast(v.DOC_DATE_END as date) as DOC_DATE_END,
       cast(v.DOC_DATE_ISSUE as date) as DOC_DATE_ISSUE,
       v.DOC_NUM,
       v.DOC_WHO,
       v.PLACE_BIRTH,
       v.POINT_TYPE,
       v.SEGMENT_GROUP_PHOTO,
       v.DOVER_LAST_NAME,
       v.DOVER_FIRST_NAME,
       v.DOVER_SUR_NAME,
       v.DOVER_IIN,
       cast(v.DOVER_DATE_BIRTH as date) as DOVER_DATE_BIRTH,
       cast(v.DOVER_DATE_DOC_ISSUE as date) as DOVER_DATE_DOC_ISSUE,
       cast(v.DOVER_DATE_DOC_END as date) as DOVER_DATE_DOC_END,
       v.DOVER_NUM_DOC,
       v.DOVER_WHO_DOC,
       v.DOVER_PLACE_BIRTH,
       v.DOVER_LAST_NAME_WIFE,
       v.DOVER_FIRST_NAME_WIFE,
       v.DOVER_SUR_NAME_WIFE,
       cast(v.DOVER_WIFE_DATE_BIRTH as date) as DOVER_WIFE_DATE_BIRTH,
       v.DOVER_ORG_NAME,
       v.DOVER_ORG_CASTA,
       v.DOVER_ORG_STAZH_DATE,
       v.MANAGER_FIO,
       v.DOVER_CAUSE_REMOVE,
       v.LAWYER_COMMENT,
       v.TRUST_NUM_DOG,
       cast(v.TRUST_DATE_REG as date) as TRUST_DATE_REG,
       cast(v.TRUST_DATE_END as date) as TRUST_DATE_END,
       v.TYPE_PROD,
       v.AUTO_T_DOC_NUM,
       cast(v.AUTO_T_DOC_DATE as date) as AUTO_T_DOC_DATE,
       v.AUTO_STATE_NUM,
       v.AUTO_BRAND,
       v.AUTO_MODEL,
       v.AUTO_YEAR,
       v.AUTO_COLOUR,
       v.AUTO_BODY_NUM,
       v.AUTO_ENG_SIZE,
       v.AUTO_OWN_LAST_NAME,
       v.AUTO_OWN_FIRST_NAME,
       v.AUTO_OWN_SUR_NAME,
       v.AUTO_ZALOG

  from verificator.OUT_DWH_VERIFICATION@verifais v;
grant select on U1.M_OUT_DWH_VERIFICATION to LOADDB;
grant select on U1.M_OUT_DWH_VERIFICATION to LOADER;
grant select on U1.M_OUT_DWH_VERIFICATION to RISK_VERIF;


